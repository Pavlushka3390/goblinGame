(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var i=t.g.document;if(!e&&i&&(i.currentScript&&(e=i.currentScript.src),!e)){var l=i.getElementsByTagName("script");l.length&&(e=l[l.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const e=1,i=2,l=t.p+"2dbd01ce16c0fa83cb67.png";class s extends class{constructor(t){let{row:e,column:l}=t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;this.row=e,this.column=l,this.state=s}changeState(t){this.state=t}}{constructor(t){let{row:e,column:s}=t;super({row:e,column:s},arguments.length>1&&void 0!==arguments[1]?arguments[1]:i),this.el=document.createElement("div"),this.el.dataset.row=e,this.el.dataset.column=s,this.el.classList.add("cell"),this.el.innerHTML=`<img src="${l}">`,this.deactivate()}click(){this.state===e&&(this.deactivate(),this.el.classList.add("cell-target-defeat"),setTimeout((()=>{this.el.classList.remove("cell-target-defeat")}),500))}deactivate(){this.el.classList.remove("cell-target"),this.el.querySelector("img").classList.add("hide"),this.changeState(i)}activate(){this.el.classList.add("cell-target"),this.el.querySelector("img").classList.remove("hide"),this.changeState(e)}render(t){t.insertAdjacentElement("beforeEnd",this.el)}}class c{constructor(t){this.gameField=t,this.activeCellPosition=null,this.setListeners()}setListeners(){this.gameField.addClickListener((t=>{const{target:e}=t,i=e.closest(".cell");if(!i)return;const l={row:Number(i.dataset.row),column:Number(i.dataset.column)};this.gameField.clickCell(l)}))}start(){function t(t,e){return Math.round(t-.5+Math.random()*(e-t))}this.gameField.render(document.querySelector(".task-field")),setInterval((()=>{const e={row:t(0,this.gameField.rowCount),column:t(0,this.gameField.columnCount)};for(;this.activeCellPosition&&e.row===this.activeCellPosition.row&&e.column===this.activeCellPosition.column;)e.row=t(0,this.gameField.rowCount),e.column=t(0,this.gameField.columnCount);this.changeActiveCell(e)}),2e3)}changeActiveCell(t){this.activeCellPosition&&this.gameField.deactivate(this.activeCellPosition),this.gameField.activate(t),this.activeCellPosition=t}}class o extends class{constructor(t,e,i){this.columnCount=e,this.rowCount=t,this.CellClass=i,this.field=null,this.init()}checkFieldBoundary(t){let{column:e,row:i}=t;if(i>=this.field.length||e>=this.field[i].length||e<0||i<0)throw new Error("out of field bound")}init(){this.field=Array(this.rowCount).fill(0).map(((t,e)=>Array(this.columnCount).fill(0).map(((t,i)=>new this.CellClass({row:e,column:i})))))}}{constructor(t,e,i){super(t,e,i),this.el=document.createElement("div"),this.el.classList.add("game-field")}activate(t){let{column:e,row:i}=t;this.checkFieldBoundary({column:e,row:i}),this.field[i][e].activate()}deactivate(t){let{column:e,row:i}=t;this.checkFieldBoundary({column:e,row:i}),this.field[i][e].deactivate()}clickCell(t){let{column:e,row:i}=t;this.checkFieldBoundary({column:e,row:i}),this.field[i][e].click()}addClickListener(t){this.el.addEventListener("click",t)}render(t){t.append(this.el),this.field.forEach((t=>{t.forEach((t=>{t.render(this.el)}))}))}}!function(){const t=document.querySelector(".controls"),e=document.querySelector(".task-field"),i=document.createElement("button");i.classList.add("control"),i.textContent="Goblinslayer",t.insertAdjacentElement("beforeEnd",i),i.addEventListener("click",(()=>{e.innerHTML="";const t=new o(4,4,s);new c(t).start()}))}()})();